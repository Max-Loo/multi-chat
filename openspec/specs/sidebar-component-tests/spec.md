# 侧边栏导航组件测试规格

## 能力概述

为侧边栏导航组件（`src/components/Sidebar/`）创建全面的单元测试，确保导航交互、状态管理和国际化功能正常工作。

## 需求

### 功能需求

**REQ-1: 导航项渲染**
- 组件应渲染 3 个导航项：聊天（Chat）、模型（Model）、设置（Setting）
- 每个导航项应包含图标、提示文本（title）和正确的样式类
- 导航项应使用国际化的文本标签

**REQ-2: 路由激活状态**
- 当前路由激活的导航项应显示激活样式（activeClassName）
- 非激活导航项应显示默认样式（inactiveClassName）
- 激活状态判断应使用 `location.pathname.startsWith(item.path)` 逻辑

**REQ-3: 导航交互**
- 点击导航项应触发导航到对应路径
- 如果当前已在目标路径，不应重复导航
- 当从其他页面点击"聊天"导航且存在选中的聊天时，应导航到具体聊天页面
- 导航应使用 `navigateToChat` hook 处理聊天页面导航

**REQ-4: 国际化支持**
- 导航项标签应通过 `useTranslation` hook 获取
- 应支持中英文切换

**REQ-5: 样式和主题**
- 导航项应使用 Tailwind CSS 类进行样式设置
- 激活/非激活状态应有不同的背景色和文本颜色
- 组件应支持自定义 className（通过 props）

### 测试覆盖需求

**TEST-1: 渲染测试**
- 测试组件正常渲染 3 个导航项
- 测试导航项包含正确的图标、文本和样式类
- 测试组件接受并应用自定义 className

**TEST-2: 路由状态测试**
- 测试在 `/chat` 路由时，聊天导航项显示激活状态
- 测试在 `/model` 路由时，模型导航项显示激活状态
- 测试在 `/setting` 路由时，设置导航项显示激活状态
- 测试在子路径（如 `/chat/123`）时，父路径导航项仍显示激活状态

**TEST-3: 导航交互测试**
- 测试点击非激活导航项触发导航
- 测试点击已激活导航项不触发重复导航
- 测试从其他页面点击聊天导航时，如果有选中的聊天，导航到聊天详情
- 测试从其他页面点击聊天导航时，如果没有选中的聊天，导航到 `/chat`

**TEST-4: 边界情况测试**
- 测试当 `selectedChat` 为 null 时的导航行为
- 测试当 `selectedChat` 为 undefined 时的导航行为
- 测试组件在未提供 className prop 时的默认行为

**TEST-5: 国际化测试**
- 测试导航项标签正确使用国际化
- 测试切换语言后导航项标签更新

### 质量需求

- **代码覆盖率**：侧边栏组件的语句覆盖率 ≥ 70%
- **测试可靠性**：所有测试应独立运行，不依赖执行顺序
- **Mock 策略**：正确 mock React Router hooks（`useNavigate`、`useLocation`）和自定义 hooks（`useNavigateToChat`、`useCurrentSelectedChat`）
- **测试速度**：每个测试用例执行时间 < 100ms

## 依赖

- **React Testing Library**: 用于组件渲染和交互测试
- **Vitest**: 测试运行器
- **项目测试辅助工具**：`@/test-helpers` 中的 mock 工厂和辅助函数

## 成功标准

- 所有测试用例通过
- 代码覆盖率达到目标（≥ 70%）
- 测试文件位于 `src/__test__/components/Sidebar/` 目录
- 测试不产生控制台错误或警告
