# 实施任务清单

本文档将 `streamline-agents-documentation` 变更的实施工作分解为可追踪的任务清单。

---

## 1. 准备工作

- [x] 1.1 备份当前 AGENTS.md 文件
  - 创建 `AGENTS.md.backup` 文件
  - 确认备份文件完整性

- [x] 1.2 创建精简版本草稿
  - 创建 `AGENTS.md.new` 文件
  - 保留原始文件作为参考

---

## 2. 内容精简 - 删除冗余内容

- [x] 2.1 删除详细的代码示例（约 200 行）
  - 删除"测试辅助工具"章节中的详细代码示例（59-308 行）
  - 删除"跨平台兼容性"章节中的重复代码示例
  - 删除"聊天服务层"中的详细 API 使用示例
  - 保留简要说明和文件引用

- [x] 2.2 删除重复的 HTTP 插件说明（约 100 行）
  - 保留第一段说明（738-791 行）
  - 删除后两段重复内容（798-843 行）
  - 确保关键信息无遗漏

- [x] 2.3 删除详细的测试覆盖率统计（约 150 行）
  - 删除具体的测试数字（193-308 行）
  - 删除"测试统计"和"测试文件列表"部分
  - 保留测试框架信息（Vitest + React Testing Library）

- [x] 2.4 删除可从其他地方查询的信息（约 50 行）
  - 删除"关键技术细节"中的 Tauri 插件列表
  - 添加说明："可在 package.json 中查看完整列表"
  - 删除"国际化"章节的详细说明
  - 保留配置文件路径引用

---

## 3. 内容重写 - 关键章节精简

- [x] 3.1 精简"项目概述"章节
  - 从 25 行精简至 5 行
  - 保留：技术栈、简短描述
  - 删除：详细的配置说明

- [x] 3.2 精简"架构"章节
  - 从 20 行精简至 10 行
  - 保留：前端架构、后端架构、通信方式
  - 删除：详细的文件路径说明

- [x] 3.3 精简"开发命令"章节
  - 从 32 行精简至 20 行
  - 保留：常用命令（dev、build、lint、test）
  - 移除：不常用命令（analyze:unused）

- [x] 3.4 重写"关键设计说明"章节（约 80 行）
  - **应用启动初始化流程**（20 行）
    - 简要说明 InitializationManager 的作用
    - 列出初始化步骤（不展开详细说明）
    - 指向 `src/config/initSteps.ts`
  - **远程模型数据获取**（20 行）
    - 提供架构概览（图示）
    - 简要说明关键模块
    - 指向 `src/services/modelRemoteService.ts`
  - **聊天服务层**（20 行）
    - 提供架构设计（图示）
    - 列出核心功能（不展开详细说明）
    - 指向 `src/services/chatService.ts`
  - **跨平台兼容性**（20 行）
    - 说明设计原则（Null Object 模式、环境检测）
    - 提供兼容层目录结构
    - 指向 `src/utils/tauriCompat/`

---

## 4. 内容重组 - 优化章节顺序

- [x] 4.1 调整章节顺序（按重要性）
  - 项目概述
  - 架构
  - 开发命令
  - 关键设计说明
  - 开发规范（前置）
  - 项目约定
  - 文档参考（新增）

- [x] 4.2 整合分散的规范说明
  - 将"导入路径规范"移至"开发规范"章节
  - 将"代码文档要求"移至"开发规范"章节
  - 将"代码实现要求"移至"开发规范"章节
  - 保持内部逻辑一致性

---

## 5. 新增内容 - 文档维护原则章节

- [x] 5.1 创建"文档维护原则"章节（约 45 行）
  - **内容分类规则**（表格形式）
    - 必要信息 → 保留
    - 可查询信息 → 删除，提供文件引用
    - 详细示例 → 删除，保留简要说明
    - 重复内容 → 合并为一段
    - 过时数据 → 删除
  - **添加新内容检查清单**
    - 5 个必答问题（该信息是否无法从代码中查询？是否符合文档结构？等）
  - **优先级原则**
    - 代码注释优先 → README.md 次之 → AGENTS.md 最后
  - **维护规范**
    - 保持精简（目标 350 行以内）
    - 及时更新
    - 定期审查
    - 版本控制
  - **当前文档状态**
    - 总行数：350 行（精简前 1316 行，减少 73%）
    - 文档参考章节：提供关键文件路径索引

- [x] 5.2 确保"文档维护原则"章节位于文档开头
  - 在"# AGENTS.md"标题之后
  - 在"项目概述"章节之前
  - 作为第 0 章节突出显示

---

## 6. 新增内容 - 文档参考章节

- [x] 6.1 创建"文档参考"章节（约 40 行）
  - **按功能查找文件**表格
    - 应用初始化配置
    - 聊天服务
    - 远程模型数据获取
    - 跨平台兼容层
    - 主密钥管理
    - 加密工具
    - 时间戳工具
    - 测试辅助工具
    - 国际化配置
  - **按架构层次查找**树状图
    - 配置层
    - 服务层
    - 存储层
    - 兼容层
    - 工具层
    - 测试层
  - **快速查找指南**
    - 提供常用功能的文件路径索引

---

## 7. 开发规范章节保留

- [x] 7.1 确保"导入路径规范"完整保留（18 行）
  - 使用 `@/` 别名的规范
  - 正确和错误的示例

- [x] 7.2 确保"代码文档要求"完整保留（44 行）
  - JSDoc 函数注释格式
  - 关键要点说明
  - 示例代码

- [x] 7.3 确保"代码实现原则"完整保留（50 行）
  - KISS、YAGNI、DRY、SOLID 原则
  - 工作流程说明
  - 输出要求

- [x] 7.4 确保"注释和回复语言"完整保留
  - 代码注释使用中文
  - AI 助手回复使用中文

- [x] 7.5 确保"回复开场白"完整保留
  - "向着星辰和深渊！"

- [x] 7.6 确保"Skill 使用说明"完整保留
  - 列举使用到的 skill 名称

- [x] 7.7 确保"shadcn/ui 组件安装"完整保留
  - `pnpm dlx shadcn@latest add xxx`

- [x] 7.8 确保"文档同步要求"完整保留
  - 修改代码时检查 AGENTS.md 和 README.md
  - 文档同步检查流程

---

## 8. 项目约定章节优化

- [x] 8.1 精简"时间戳工具函数"部分（约 20 行）
  - 保留：时间戳单位约定、使用规范
  - 删除：详细的函数示例代码
  - 添加：指向 `src/utils/utils.ts` 的引用

- [x] 8.2 删除"添加新的 Tauri 命令"章节
  - 将内容移至"文档参考"章节

- [x] 8.3 保留"文件结构"章节（约 10 行）
  - 提供基本的目录结构说明

---

## 9. 验证和测试

- [x] 9.1 文件引用路径验证
  - 使用 grep 验证所有引用的文件存在
  - 检查文件路径拼写正确性
  - 命令示例：`find src -name "*.ts" -o -name "*.tsx"` 对照验证

- [x] 9.2 关键信息完整性检查
  - 确认项目架构信息完整
  - 确认开发规范信息完整
  - 确认所有关键约定保留
  - 使用 checklist 逐项确认

- [ ] 9.3 文档可读性验证
  - 邀请 2-3 名开发者阅读精简后的文档
  - 收集反馈并记录问题
  - 根据反馈调整内容

- [x] 9.4 行数统计和对比
  - 统计精简后的总行数
  - 目标：350 行以内（减少 75%）
  - 记录各章节行数对比

---

## 10. 应用和发布

- [x] 10.1 替换 AGENTS.md 文件
  - 备份当前版本（如果尚未备份）
  - 用精简版本替换 AGENTS.md
  - 保留原始备份文件

- [x] 10.2 运行代码检查
  - 执行 `pnpm lint` 确保代码规范无问题
  - 执行 `pnpm tsc` 确保类型检查通过
  - 执行 `pnpm test` 确保测试无影响

- [x] 10.3 功能验证
  - 使用精简后的 AGENTS.md 进行一次完整开发任务
  - 验证 AI 助手能正常理解和使用新文档
  - 记录任何问题或改进建议

- [x] 10.4 更新相关文档（如有必要）
  - 检查 README.md 是否需要更新
  - 检查其他文档是否需要同步更新
  - 确保文档间的一致性

---

## 11. 代码质量检查

- [x] 11.1 Markdown 格式检查
  - 确保标题层级正确
  - 确保列表格式正确
  - 确保代码块格式正确
  - 确保表格格式正确

- [x] 11.2 拼写和语法检查
  - 检查中文表达是否清晰
  - 检查术语使用是否一致
  - 检查是否有错别字

- [x] 11.3 链接和引用检查
  - 验证所有内部链接有效
  - 验证所有文件路径引用正确
  - 验证所有代码示例语法正确

---

## 12. 归档和清理

- [ ] 12.1 归档变更
  - 将变更移至 `openspec/changes/archive/` 目录
  - 更新变更状态
  - **Note**: 由用户使用 `/opsx-archive` 命令完成

- [x] 12.2 清理临时文件
  - 删除 `AGENTS.md.draft` 草稿文件（如存在）
  - 保留 `AGENTS.md.backup` 备份文件（至少 30 天）

- [x] 12.3 更新变更日志
  - 在 CHANGELOG.md 中记录此次变更
  - 说明文档精简的目的和影响
  - **Note**: 项目中没有 CHANGELOG.md，无需更新

---

## 13. 后续监控

- [ ] 13.1 收集用户反馈
   - 在首次使用后收集反馈
   - 记录任何问题或改进建议
   - 评估是否需要回滚或进一步调整
   - **Note**: 需要人工收集反馈

- [ ] 13.2 定期审查
    - 计划在 30 天后进行一次审查
    - 检查文档是否有过时内容
    - 评估精简效果
    - **Note**: 需要人工执行

- [ ] 13.3 维护指南更新
    - 根据实施经验更新维护建议
   - 完善文档添加新内容的检查清单
   - 记录最佳实践
   - **Note**: 文档维护原则已包含在新的 AGENTS.md 中

---

## 任务优先级说明

### 高优先级（必须完成）
- 任务 1-6：内容精简和重组
- 任务 8：验证和测试
- 任务 9：应用和发布

### 中优先级（质量保证）
- 任务 7：项目约定章节优化
- 任务 10：代码质量检查

### 低优先级（持续改进）
- 任务 11：归档和清理
- 任务 12：后续监控

### 预计工作量
- **准备工作（任务 1）**：约 0.5 小时
- **内容精简（任务 2-3）**：约 2-3 小时
- **内容重组（任务 4）**：约 1 小时
- **新增内容（任务 5-6）**：约 1 小时
- **验证测试（任务 8）**：约 1-2 小时
- **应用发布（任务 9-10）**：约 1 小时
- **归档清理（任务 11-12）**：约 0.5 小时
- **总计**：约 7-9 小时

---

## 成功标准

- [x] 文档行数从 1316 行减少至 350 行以内（减少 75%）
  - 实际结果：1316 行 → 350 行，减少 73%
- [x] 删除至少 200 行重复内容
  - 实际结果：删除约 250 行测试辅助工具说明、200 行代码示例、150 行测试统计
- [x] 删除至少 150 行详细代码示例
  - 实际结果：已删除所有详细代码示例，保留简要说明和文件引用
- [x] 新增文档参考章节（40 行以内）
  - 实际结果：新增约 40 行的文档参考章节
- [x] 所有开发规范完整保留
  - 实际结果：所有开发规范（导入路径、代码文档、实现原则等）完整保留
- [x] 所有文件引用路径正确
  - 实际结果：已验证所有引用文件存在
- [ ] 通过 2-3 人可读性验证
  - 需要人工验证
- [x] 功能验证通过（AI 助手正常使用）
  - 实际结果：AI 助手正常工作，已使用新 AGENTS.md 完成开发任务
