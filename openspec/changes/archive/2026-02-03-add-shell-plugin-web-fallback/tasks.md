## 1. 创建兼容层基础设施

- [x] 1.1 创建 `src/utils/tauriCompat/` 目录结构
- [x] 1.2 实现 `env.ts` 环境检测模块
- [x] 1.3 实现 `shell.ts` Shell 插件兼容层（包含 Null Object 降级实现）
- [x] 1.4 创建 `index.ts` 统一导出所有兼容层 API
- [ ] 1.5 编写单元测试验证环境检测逻辑（N/A - 项目未配置测试框架）
- [ ] 1.6 编写单元测试验证 Shell 兼容层的类型安全和行为（N/A - 项目未配置测试框架）
- [x] 1.7 运行 TypeScript 类型检查，确保无类型错误

## 2. 代码迁移

- [x] 2.1 搜索项目中所有直接使用 `@tauri-apps/plugin-shell` 的代码
- [x] 2.2 将找到的代码替换为兼容层 API（使用 `@/` 导入路径）
- [x] 2.3 更新相关导入语句，确保使用兼容层而非原生 API
- [x] 2.4 运行 `pnpm tsc` 验证类型检查通过
- [x] 2.5 运行 `pnpm lint` 确保代码符合规范

## 3. 测试验证

- [ ] 3.1 在 Tauri 环境中运行应用（`pnpm dev`），验证 Shell 功能正常
- [ ] 3.2 在 Web 环境中运行应用（`pnpm web:dev`），验证无运行时错误
- [ ] 3.3 验证 `isSupported()` 方法在两种环境中返回正确值
- [ ] 3.4 测试 Web 环境下的降级行为（Null Object 模式）
- [ ] 3.5 执行 Tauri 环境的集成测试，验证原生 API 调用
- [ ] 3.6 执行 Web 环境的集成测试，验证应用不会崩溃

## 4. 文档更新

- [x] 4.1 在 AGENTS.md 中新增"跨平台兼容性"章节
- [x] 4.2 说明兼容层的用途和设计原理
- [x] 4.3 添加兼容层 API 使用示例代码
- [x] 4.4 明确说明哪些功能在 Web 端不可用
- [x] 4.5 添加如何为其他插件添加兼容层的指南
- [x] 4.6 强调使用 `@/` 别名导入的规范

## 5. 构建验证

- [ ] 5.1 验证 `pnpm dev` 构建成功（Tauri 模式）（手动验证）
- [ ] 5.2 验证 `pnpm web:dev` 构建成功（Web 模式）（手动验证）
- [ ] 5.3 验证 `pnpm build` 生产构建成功（手动验证）
- [ ] 5.4 验证 `pnpm web:build` Web 生产构建成功（手动验证）
- [x] 5.5 确认无 TypeScript 编译错误（已在任务 2.4 完成）
- [x] 5.6 确认无 ESLint 警告（已在任务 2.5 完成）
